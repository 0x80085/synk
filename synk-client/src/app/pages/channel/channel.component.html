<div
  *ngIf="isConnected$ | async; then channelStage; else connectionState"
></div>

<ng-template #channelStage>
  <div nz-row [nzGutter]="{ xs: 0, sm: 0, md: 24, lg: 32, xl: 32, xxl: 32 }">
    <div
      nz-col
      [nzLg]="{ span: 6, offset: 0 }"
      [nzMd]="{ span: 6, offset: 0 }"
      [nzXs]="{ span: 24, offset: 0 }"
    >
      <app-chat-room [name]="name" class="hide-on-mobile"></app-chat-room>
    </div>

    <div nz-col nzSpan="18">
      <app-media
        *ngIf="playlist$ | async"
        #player
        (mediaEndedEvent)="onVideoEnded()"
      ></app-media>
    </div>
  </div>

  <div nz-row [nzGutter]="{ xs: 0, sm: 0, md: 24, lg: 32, xl: 32, xxl: 32 }">
    <div nz-col nzSpan="6" class="mt-1 hide-on-mobile">
      <app-connected-members
        (giveLeader)="giveLeader($event)"
      ></app-connected-members>
    </div>

    <div nz-col nzSpan="18" class="mt-1 hide-on-mobile">
      <app-playlist
        [roomName]="name"
        (playMedia)="player.play($event.mediaUrl)"
      >
      </app-playlist>
    </div>
  </div>
</ng-template>

<ng-template #connectionState>
  <div
    *ngIf="isLoading$ | async; then busyConnecting; else errorConnecting"
  ></div>
</ng-template>

<ng-template #errorConnecting>
  <div nz-col nzSpan="24" class="column">
    <nz-empty
      [nzNotFoundImage]="disconnectedImg"
      [nzNotFoundContent]="disconnectedText"
    >
    </nz-empty>
  </div>
</ng-template>

<ng-template #busyConnecting>
  <div nz-col nzSpan="24" class="column">
    <nz-empty
      [nzNotFoundImage]="busyConnectingImg"
      [nzNotFoundContent]="busyConnectingText"
    >
    </nz-empty>
  </div>
</ng-template>

<ng-template #disconnectedImg>
  <i
    nz-icon
    style="font-size: 5rem; color: rgb(204, 254, 253)"
    nzTheme="fill"
    nzType="meh"
  ></i>
</ng-template>

<ng-template #disconnectedText>
  <h2>Please log in to enter this room</h2>
  <p>Only logged in users can access rooms</p>
</ng-template>

<ng-template #busyConnectingImg>
  <i
    nz-icon
    style="font-size: 5rem; color: rgb(204, 254, 253)"
    nzType="sync"
    [nzSpin]="true"
  ></i>
</ng-template>

<ng-template #busyConnectingText>
  <h4>Connecting to server...</h4>
</ng-template>
