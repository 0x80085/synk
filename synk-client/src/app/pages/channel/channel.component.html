<p>Channel: {{ name }}</p>

<div
  nz-row
  nzSpan="24"
  nzType="flex"
  nzGutter="16"
  nzJustify="space-between"
  nzAlign="stretch"
>
  <nz-alert
    nz-col
    *ngFor="let item of errorEvent$ | async"
    nzSpan="6"
    nzType="error"
    [nzShowIcon]="true"
    [nzMessage]="item.text"
  ></nz-alert>
  <div
    nz-row
    nzType="flex"
    [nzGutter]="{ xs: 8, sm: 16, md: 24, lg: 32, xl: 32, xxl: 32 }"
    nzJustify="space-between"
    nzAlign="stretch"
    *ngIf="!(errorEvent$ | async); then channelStage; else errorConnecting"
  ></div>
</div>

<ng-template #channelStage>
  <div
    nz-col
    nzSpan="6"
    ngType="flex"
    class="column gutter-row"
    style="display:flex;"
  >
    <app-chat-room [name]="name"></app-chat-room>
  </div>
  <div nz-col nzSpan="18" class="column gutter-row">
    <app-media #player (mediaEndedEvent)="onVideoEnded()"></app-media>
  </div>
  <div nz-col nzSpan="18" nzOffset="6" class="playlist">
    <nz-list
      nzBordered
      nzSize="small"
      [nzDataSource]="playlist"
      [nzRenderItem]="item"
      [nzNoResult]="'No items'"
    >
      <ng-template #item let-item>
        <li
          nz-list-item
          class="playlist-item"
          [nzContent]="item"
          [nzActions]="[opAction]"
          nzNoFlex
        ></li>
        <ng-template #opAction>
          <a (click)="player.play(item)">
            Play
          </a>
        </ng-template>
      </ng-template>
    </nz-list>
  </div>
</ng-template>

<ng-template #errorConnecting>
  <div nz-col nzSpan="24" class="column">
    <nz-empty
      nzNotFoundContent="Can't connect to channel. Did you log in?"
    ></nz-empty>
  </div>
</ng-template>
